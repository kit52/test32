"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[188],{11:function(e,a,t){t.d(a,{I:function(){return n}});var s=t(7294),r=t(3007),l=t(5893);const n=(0,s.memo)((e=>{const{className:a,value:t,onChange:n,type:o="text",placeholder:c,autofocus:i,readonly:d,...u}=e,v=(0,s.useRef)(null),[h,g]=(0,s.useState)(!1),[m,p]=(0,s.useState)(0),j=h&&!d;return(0,s.useEffect)((()=>{var e;i&&(g(!0),null===(e=v.current)||void 0===e||e.focus())}),[i]),(0,l.jsxs)("div",{className:(0,r.A)("LuFDUWoP",{},[a]),children:[c&&(0,l.jsx)("div",{className:"emAQQ85i",children:"".concat(c,">")}),(0,l.jsxs)("div",{className:"y1GiFC_L",children:[(0,l.jsx)("input",{ref:v,type:o,value:t,onChange:e=>{null==n||n(e.target.value),p(e.target.value.length)},className:"LVdIPwcx",onFocus:()=>{g(!0)},onBlur:()=>{g(!1)},onSelect:e=>{var a;p((null==e||null===(a=e.target)||void 0===a?void 0:a.selectionStart)||0)},readOnly:d,...u}),j&&(0,l.jsx)("span",{className:"lqMFGBuL",style:{left:"".concat(9*m,"px")}})]})]})}))},9074:function(e,a,t){t.r(a),t.d(a,{default:function(){return ae}});var s=t(2327),r=t(7294),l=t(9711),n=t(3007),o=t(1233),c=t(9970),i=t(5401),d=t(1492),u=t(743),v=t(2576),h=t(8699),g=t(4268),m=t(1283);const p=e=>{var a;return(null===(a=e.articlesPage)||void 0===a?void 0:a.isLoading)||!1},j=e=>{var a;return null===(a=e.articlesPage)||void 0===a?void 0:a.error},x=e=>{var a;return(null===(a=e.articlesPage)||void 0===a?void 0:a.view)||v.GA.SMALL},y=e=>{var a;return(null===(a=e.articlesPage)||void 0===a?void 0:a.page)||1},w=e=>{var a,t;return null!==(a=null===(t=e.articlesPage)||void 0===t?void 0:t.order)&&void 0!==a?a:"asc"},C=e=>{var a,t;return null!==(a=null===(t=e.articlesPage)||void 0===t?void 0:t.sort)&&void 0!==a?a:v.$B.CREATED},f=e=>{var a,t;return null!==(a=null===(t=e.articlesPage)||void 0===t?void 0:t.search)&&void 0!==a?a:""},N=e=>{var a,t;return null!==(a=null===(t=e.articlesPage)||void 0===t?void 0:t.type)&&void 0!==a?a:v.Iq.ALL},S=(0,g.hg)("articlesPage/fetchArticlesList",(async(e,a)=>{const{extra:t,rejectWithValue:s,getState:r}=a,l=(null===(n=r().articlesPage)||void 0===n?void 0:n.limit)||9;var n;const o=C(r()),c=w(r()),i=f(r()),d=y(r()),u=N(r());try{h={sort:o,order:c,search:i,type:u},window.history.pushState(null,"",function(e){const a=new URLSearchParams(window.location.search);return Object.entries(e).forEach((e=>{let[t,s]=e;void 0!==s&&a.set(t,s)})),"?".concat(a.toString())}(h));const e=await t.api.get("/articles",{params:{_expand:"user",_limit:l,_page:d,_sort:o,_order:c,q:i,type:u===v.Iq.ALL?void 0:u}});if(!e.data)throw new Error;return e.data}catch(e){return s("error")}var h})),A=(0,g.HF)({selectId:e=>e.id}),b=A.getSelectors((e=>e.articlesPage||A.getInitialState())),P=(0,g.oM)({name:"articlesPageSlice",initialState:A.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{},view:v.GA.SMALL,page:1,hasMore:!0,_inited:!1,limit:9,sort:v.$B.CREATED,search:"",order:"asc",type:v.Iq.ALL}),reducers:{setView:(e,a)=>{e.view=a.payload,localStorage.setItem(m.fK,a.payload)},setPage:(e,a)=>{e.page=a.payload},setOrder:(e,a)=>{e.order=a.payload},setSort:(e,a)=>{e.sort=a.payload},setType:(e,a)=>{e.type=a.payload},setSearch:(e,a)=>{e.search=a.payload},initState:e=>{const a=localStorage.getItem(m.fK);e.view=a,e.limit=a===v.GA.BIG?4:9,e._inited=!0}},extraReducers:e=>{e.addCase(S.pending,((e,a)=>{e.error=void 0,e.isLoading=!0,a.meta.arg.replace&&A.removeAll(e)})).addCase(S.fulfilled,((e,a)=>{e.isLoading=!1,e.hasMore=a.payload.length>=e.limit,a.meta.arg.replace?A.setAll(e,a.payload):A.addMany(e,a.payload)})).addCase(S.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload}))}}),{reducer:L,actions:k}=P;var I=t(5893);const O=(0,r.memo)((e=>{const{className:a}=e,t=(0,u.v9)(b.selectAll),r=(0,u.v9)(p),l=(0,u.v9)(x),n=(0,u.v9)(j),{t:o}=(0,s.$)();return n?(0,I.jsx)(h.xv,{text:o("Ошибка при загрузке статей")}):(0,I.jsx)(v.wD,{isLoading:r,view:l,articles:t,className:a})}));var T=t(1554),E=t(11),M={sortWrapper:"pyOjonnp",search:"QkNSez8q",tabs:"JHbc4jKB"};const q=e=>{const{className:a,label:t,options:s,onChange:l,value:o,readonly:c}=e,i=(0,r.useMemo)((()=>null==s?void 0:s.map((e=>(0,I.jsx)("option",{className:"JkXz98qY",value:e.value,children:e.content},e.value)))),[s]);return(0,I.jsxs)("div",{className:(0,n.A)("cidfdn6H",{},[a]),children:[t&&(0,I.jsx)("span",{className:"G1uuf7Bp",children:"".concat(t,">")}),(0,I.jsx)("select",{disabled:c,className:"VOKOuKGo",value:o,onChange:e=>{l&&l(e.target.value)},children:i})]})};const R=(0,r.memo)((e=>{const{className:a,onChangeOrder:t,onChangeSort:l,order:o,sort:c}=e,{t:i}=(0,s.$)(),d=(0,r.useMemo)((()=>[{value:"asc",content:i("возрастанию")},{value:"desc",content:i("убыванию")}]),[i]),u=(0,r.useMemo)((()=>[{value:v.$B.CREATED,content:i("дате создания")},{value:v.$B.TITLE,content:i("названию")},{value:v.$B.VIEWS,content:i("просмотрам")}]),[i]);return(0,I.jsxs)("div",{className:(0,n.A)("NPdgTkVB",{},[a]),children:[(0,I.jsx)(q,{options:u,label:i("Сортировать ПО"),value:c,onChange:l}),(0,I.jsx)(q,{options:d,label:i("по"),value:o,onChange:t,className:"wykpgrxz"})]})}));var V;function B(){return B=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},B.apply(this,arguments)}var G;function _(){return _=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},_.apply(this,arguments)}var Z=t(7088),$=t(9499),D={notSelected:"F73jjI_o"};const F=[{view:v.GA.SMALL,icon:e=>r.createElement("svg",_({width:24,height:24,xmlns:"http://www.w3.org/2000/svg"},e),G||(G=r.createElement("path",{d:"M6 4h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Zm7 9v5h5v-5h-5Zm-7 0v5h5v-5H6Zm7-7v5h5V6h-5ZM6 6v5h5V6H6Z"})))},{view:v.GA.BIG,icon:e=>r.createElement("svg",B({width:24,height:24,xmlns:"http://www.w3.org/2000/svg"},e),V||(V=r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.75 18a.75.75 0 0 1 .75-.75h15a.75.75 0 1 1 0 1.5h-15a.75.75 0 0 1-.75-.75Zm0-6a.75.75 0 0 1 .75-.75h15a.75.75 0 1 1 0 1.5h-15a.75.75 0 0 1-.75-.75Zm0-6a.75.75 0 0 1 .75-.75h15a.75.75 0 1 1 0 1.5h-15A.75.75 0 0 1 3.75 6Z"})))}],H=(0,r.memo)((e=>{const{className:a,view:t,onViewClick:s}=e;return(0,I.jsx)("div",{className:(0,n.A)(D.ArticleViewSelector,{},[a]),children:F.map((e=>{return(0,I.jsx)($.zx,{theme:$.bn.CLEAR,onClick:(a=e.view,()=>{null==s||s(a)}),children:(0,I.jsx)(Z.J,{Svg:e.icon,className:(0,n.A)("",{[D.notSelected]:e.view!==t})})},e.view);var a}))})}));var W=t(6425),K={Tabs:"bXYDRoXv"};const U=(0,r.memo)((e=>{const{className:a,tabs:t,onTabClick:s,value:l}=e,o=(0,r.useCallback)((e=>()=>{s(e)}),[s]);return(0,I.jsx)("div",{className:(0,n.A)(K.Tabs,{},[a]),children:t.map((e=>(0,I.jsx)(W.Z,{theme:e.value===l?W.r.NORMAL:W.r.OUTLINED,className:K.tab,onClick:o(e),children:e.content},e.value)))})})),z=(0,r.memo)((e=>{const{className:a,value:t,onChangeType:l}=e,{t:o}=(0,s.$)(),c=(0,r.useMemo)((()=>[{value:v.Iq.ALL,content:o("Все статьи")},{value:v.Iq.IT,content:o("Айти")},{value:v.Iq.ECONOMICS,content:o("Экономика")},{value:v.Iq.SCIENCE,content:o("Наука")}]),[o]),i=(0,r.useCallback)((e=>{l(e.value)}),[l]);return(0,I.jsx)(U,{tabs:c,value:t,onTabClick:i,className:(0,n.A)("",{},[a])})})),Q=(0,r.memo)((e=>{const{className:a}=e,{t:t}=(0,s.$)(),l=(0,i.T)(),o=(0,u.v9)(x),c=(0,u.v9)(C),d=(0,u.v9)(w),v=(0,u.v9)(f),h=(0,u.v9)(N),g=(0,r.useCallback)((()=>{l(S({replace:!0}))}),[l]),m=function(e,a){const t=(0,r.useRef)();return(0,r.useCallback)((function(){for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{e(...s)}),500)}),[e,500])}(g),p=(0,r.useCallback)((e=>{l(k.setView(e))}),[l]),j=(0,r.useCallback)((e=>{l(k.setSort(e)),l(k.setPage(1)),g()}),[l,g]),y=(0,r.useCallback)((e=>{l(k.setOrder(e)),l(k.setPage(1)),g()}),[l,g]),A=(0,r.useCallback)((e=>{l(k.setSearch(e)),l(k.setPage(1)),m()}),[l,m]),b=(0,r.useCallback)((e=>{l(k.setType(e)),l(k.setPage(1)),g()}),[l,g]);return(0,I.jsxs)("div",{className:(0,n.A)(M.ArticlesPageFilters,{},[a]),children:[(0,I.jsxs)("div",{className:M.sortWrapper,children:[(0,I.jsx)(R,{order:d,sort:c,onChangeOrder:y,onChangeSort:j}),(0,I.jsx)(H,{view:o,onViewClick:p})]}),(0,I.jsx)(T.Z,{className:M.search,children:(0,I.jsx)(E.I,{onChange:A,value:v,placeholder:t("Поиск")})}),(0,I.jsx)(z,{value:h,onChangeType:b,className:M.tabs})]})})),J=(0,g.hg)("articlesPage/fetchNextArticlesPage",(async(e,a)=>{const{getState:t,dispatch:s}=a,r=null===(l=t().articlesPage)||void 0===l?void 0:l.hasMore;var l;const n=y(t()),o=p(t());r&&!o&&(s(k.setPage(n+1)),s(S({})))})),X=(0,g.hg)("articlesPage/initArticlesPage",(async(e,a)=>{const{getState:t,dispatch:s}=a;var r;if(!(null===(r=t().articlesPage)||void 0===r?void 0:r._inited)){const a=e.get("order"),t=e.get("sort"),r=e.get("search"),l=e.get("type");a&&s(k.setOrder(a)),t&&s(k.setSort(t)),r&&s(k.setSearch(r)),l&&s(k.setType(l)),s(k.initState()),s(S({}))}}));const Y={articlesPage:L},ee=e=>{const{className:a}=e,{t:t}=(0,s.$)(),u=(0,i.T)(),[v]=(0,l.lr)(),h=(0,r.useCallback)((()=>{u(J())}),[u]);return(0,c.Q)((()=>{u(X(v))})),(0,I.jsx)(o.W,{reducers:Y,removeAfterUnmount:!1,children:(0,I.jsxs)(d.T,{onScrollEnd:h,className:(0,n.A)("i0h17Gqm",{},[a]),children:[(0,I.jsx)(Q,{}),(0,I.jsx)(O,{className:"UsH35LqR"})]})})};var ae=(0,r.memo)(ee)}}]);