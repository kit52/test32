"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[59],{11:function(e,a,n){n.d(a,{I:function(){return o}});var r=n(7294),l=n(3007),t=n(5893);const o=(0,r.memo)((e=>{const{className:a,value:n,onChange:o,type:s="text",placeholder:i,autofocus:d,readonly:c,...u}=e,v=(0,r.useRef)(null),[C,h]=(0,r.useState)(!1),[m,g]=(0,r.useState)(0),f=C&&!c;return(0,r.useEffect)((()=>{var e;d&&(h(!0),null===(e=v.current)||void 0===e||e.focus())}),[d]),(0,t.jsxs)("div",{className:(0,l.A)("LuFDUWoP",{},[a]),children:[i&&(0,t.jsx)("div",{className:"emAQQ85i",children:"".concat(i,">")}),(0,t.jsxs)("div",{className:"y1GiFC_L",children:[(0,t.jsx)("input",{ref:v,type:s,value:n,onChange:e=>{null==o||o(e.target.value),g(e.target.value.length)},className:"LVdIPwcx",onFocus:()=>{h(!0)},onBlur:()=>{h(!1)},onSelect:e=>{var a;g((null==e||null===(a=e.target)||void 0===a?void 0:a.selectionStart)||0)},readOnly:c,...u}),f&&(0,t.jsx)("span",{className:"lqMFGBuL",style:{left:"".concat(9*m,"px")}})]})]})}))},2059:function(e,a,n){n.r(a),n.d(a,{default:function(){return M}});var r=n(6974),l=n(3007),t=n(1492),o=n(9457),s=n(2327),i=n(7294),d=n(743),c=n(5401),u=n(9970),v=n(8699),C=n(11),h=n(3053),m=n(9960);let g;!function(e){e.RUB="RUB",e.EUR="EUR",e.USD="USD"}(g||(g={}));var f=n(7662),p=n(5893);const R=[{value:g.RUB,content:g.RUB},{value:g.EUR,content:g.EUR},{value:g.USD,content:g.USD}],x=(0,i.memo)((e=>{let{className:a,value:n,onChange:r,readonly:l}=e;const{t:t}=(0,s.$)(),o=(0,i.useCallback)((e=>{null==r||r(e)}),[r]);return(0,p.jsx)(f.wb,{className:a,value:n,defaultValue:t("Укажите валюту"),label:t("Укажите валюту"),items:R,onChange:o,readonly:l,direction:"top right"})}));let y;!function(e){e.Russia="Russia",e.Belarus="Belarus",e.Ukraine="Ukraine",e.Kazakhstan="Kazahstan",e.Armenia="Armenia"}(y||(y={}));const E=[{value:y.Armenia,content:y.Armenia},{value:y.Russia,content:y.Russia},{value:y.Belarus,content:y.Belarus},{value:y.Kazakhstan,content:y.Kazakhstan},{value:y.Ukraine,content:y.Ukraine}],N=(0,i.memo)((e=>{let{className:a,value:n,onChange:r,readonly:l}=e;const{t:t}=(0,s.$)(),o=(0,i.useCallback)((e=>{null==r||r(e)}),[r]);return(0,p.jsx)(f.wb,{onChange:o,value:n,defaultValue:t("Укажите страну"),label:t("Укажите страну"),items:E,readonly:l,direction:"top right"})}));var j={ProfileCard:"wW9jgKKD",loading:"t07ZxFGs",error:"i5YK3SSb",editing:"DjTe7269"};const A=e=>{const{className:a,data:n,isLoading:r,error:t,readonly:i,onChangeFirstname:d,onChangeLastname:c,onChangeAge:u,onChangeCity:g,onChangeAvatar:f,onChangeUsername:R,onChangeCountry:y,onChangeCurrency:E}=e,{t:A}=(0,s.$)("profile");if(r)return(0,p.jsx)(o.U,{justify:"center",max:!0,className:(0,l.A)(j.ProfileCard,{[j.loading]:!0},[a]),children:(0,p.jsx)(h.a,{})});if(t)return(0,p.jsx)(o.U,{justify:"center",max:!0,className:(0,l.A)(j.ProfileCard,{},[a,j.error]),children:(0,p.jsx)(v.xv,{theme:v.lg.ERROR,title:A("Произошла ошибка при загрузке профиля"),text:A("Попробуйте обновить страницу"),align:v.PH.CENTER})});const U={[j.editing]:!i};return(0,p.jsxs)(o.g,{gap:"8",max:!0,className:(0,l.A)(j.ProfileCard,U,[a]),children:[(null==n?void 0:n.avatar)&&(0,p.jsx)(o.U,{justify:"center",max:!0,className:j.avatarWrapper,children:(0,p.jsx)(m.q,{src:null==n?void 0:n.avatar})}),(0,p.jsx)(C.I,{value:null==n?void 0:n.first,placeholder:A("Ваше имя"),className:j.input,onChange:d,readonly:i}),(0,p.jsx)(C.I,{value:null==n?void 0:n.lastname,placeholder:A("Ваша фамилия"),className:j.input,onChange:c,readonly:i}),(0,p.jsx)(C.I,{value:null==n?void 0:n.age,placeholder:A("Ваш возраст"),className:j.input,onChange:u,readonly:i}),(0,p.jsx)(C.I,{value:null==n?void 0:n.city,placeholder:A("Город"),className:j.input,onChange:g,readonly:i}),(0,p.jsx)(C.I,{value:null==n?void 0:n.username,placeholder:A("Введите имя пользователя"),className:j.input,onChange:R,readonly:i}),(0,p.jsx)(C.I,{value:null==n?void 0:n.avatar,placeholder:A("Введите ссылку на аватар"),className:j.input,onChange:f,readonly:i}),(0,p.jsx)(x,{className:j.input,value:null==n?void 0:n.currency,onChange:E,readonly:i}),(0,p.jsx)(N,{className:j.input,value:null==n?void 0:n.country,onChange:y,readonly:i})]})};var U=n(1233);let O;!function(e){e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR"}(O||(O={}));const T=e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.form},b=e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.isLoading},_=e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.error},k=e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.readonly},I=e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.validateErrors};var S=n(4268);const D=(0,S.hg)("profile/fetchProfileData",(async(e,a)=>{const{extra:n,rejectWithValue:r}=a;try{const a=await n.api.get("/profile/".concat(e));if(!a.data)throw new Error;return a.data}catch(e){return console.log(e),r("error")}})),L=(0,S.hg)("profile/updateProfileData",(async(e,a)=>{const{extra:n,rejectWithValue:r,getState:l}=a,t=T(l()),o=(e=>{if(!e)return[O.NO_DATA];const{first:a,lastname:n,age:r,country:l}=e,t=[];return a&&n||t.push(O.INCORRECT_USER_DATA),r&&Number.isInteger(r)||t.push(O.INCORRECT_AGE),l||t.push(O.INCORRECT_COUNTRY),t})(t);if(o.length)return r(o);try{const e=await n.api.put("/profile/".concat(null==t?void 0:t.id),t);if(!e.data)throw new Error;return e.data}catch(e){return console.log(e),r([O.SERVER_ERROR])}})),P=(0,S.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:(e,a)=>{e.readonly=a.payload},cancelEdit:e=>{e.readonly=!0,e.validateErrors=void 0,e.form=e.data},updateProfile:(e,a)=>{e.form={...e.form,...a.payload}}},extraReducers:e=>{e.addCase(D.pending,(e=>{e.error=void 0,e.isLoading=!0})).addCase(D.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload})).addCase(D.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload})).addCase(L.pending,(e=>{e.validateErrors=void 0,e.isLoading=!0})).addCase(L.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload,e.readonly=!0,e.validateErrors=void 0})).addCase(L.rejected,((e,a)=>{e.isLoading=!1,e.validateErrors=a.payload}))}}),{actions:w}=P,{reducer:B}=P;var V=n(9499),F=n(4420);const z=e=>{var a;return null===(a=e.profile)||void 0===a?void 0:a.data},G=(0,i.memo)((e=>{const{className:a}=e,{t:n}=(0,s.$)("profile"),r=(0,d.v9)(F.m5),t=(0,d.v9)(z),u=(null==r?void 0:r.id)===(null==t?void 0:t.id),C=(0,d.v9)(k),h=(0,c.T)(),m=(0,i.useCallback)((()=>{h(w.setReadonly(!1))}),[h]),g=(0,i.useCallback)((()=>{h(w.cancelEdit())}),[h]),f=(0,i.useCallback)((()=>{h(L())}),[h]);return(0,p.jsxs)(o.U,{max:!0,justify:"between",className:(0,l.A)("",{},[a]),children:[(0,p.jsx)(v.xv,{title:n("Профиль")}),u&&(0,p.jsx)("div",{children:C?(0,p.jsx)(V.zx,{theme:V.bn.OUTLINE,onClick:m,children:n("Редактировать")}):(0,p.jsxs)(o.U,{gap:"8",children:[(0,p.jsx)(V.zx,{theme:V.bn.OUTLINE_RED,onClick:g,children:n("Отменить")}),(0,p.jsx)(V.zx,{theme:V.bn.OUTLINE,onClick:f,children:n("Сохранить")})]})})]})})),K={profile:B},W=(0,i.memo)((e=>{const{className:a,id:n}=e,{t:r}=(0,s.$)("profile"),t=(0,c.T)(),C=(0,d.v9)(T),h=(0,d.v9)(b),m=(0,d.v9)(_),g=(0,d.v9)(k),f=(0,d.v9)(I),R={[O.SERVER_ERROR]:r("Серверная ошибка при сохранении"),[O.INCORRECT_COUNTRY]:r("Некорректный регион"),[O.NO_DATA]:r("Данные не указаны"),[O.INCORRECT_USER_DATA]:r("Имя и фамилия обязательны"),[O.INCORRECT_AGE]:r("Некорректный возраст")};(0,u.Q)((()=>{n&&t(D(n))}));const x=(0,i.useCallback)((e=>{t(w.updateProfile({first:e||""}))}),[t]),y=(0,i.useCallback)((e=>{t(w.updateProfile({lastname:e||""}))}),[t]),E=(0,i.useCallback)((e=>{t(w.updateProfile({city:e||""}))}),[t]),N=(0,i.useCallback)((e=>{t(w.updateProfile({age:Number(e||0)}))}),[t]),j=(0,i.useCallback)((e=>{t(w.updateProfile({username:e||""}))}),[t]),S=(0,i.useCallback)((e=>{t(w.updateProfile({avatar:e||""}))}),[t]),L=(0,i.useCallback)((e=>{t(w.updateProfile({currency:e}))}),[t]),P=(0,i.useCallback)((e=>{t(w.updateProfile({country:e}))}),[t]);return(0,p.jsx)(U.W,{reducers:K,children:(0,p.jsxs)(o.g,{gap:"8",max:!0,className:(0,l.A)("",{},[a]),children:[(0,p.jsx)(G,{}),(null==f?void 0:f.length)&&f.map((e=>(0,p.jsx)(v.xv,{theme:v.lg.ERROR,text:R[e]},e))),(0,p.jsx)(A,{data:C,isLoading:h,error:m,readonly:g,onChangeFirstname:x,onChangeLastname:y,onChangeAge:N,onChangeCity:E,onChangeUsername:j,onChangeAvatar:S,onChangeCurrency:L,onChangeCountry:P})]})})}));var M=e=>{let{className:a}=e;const{id:n}=(0,r.UO)();return(0,p.jsx)(t.T,{className:(0,l.A)("",{},[a]),children:(0,p.jsx)(o.g,{gap:"16",max:!0,children:(0,p.jsx)(W,{id:n})})})}},1233:function(e,a,n){n.d(a,{W:function(){return o}});var r=n(7294),l=n(743),t=n(5893);const o=e=>{const{children:a,reducers:n,removeAfterUnmount:o=!0}=e,s=(0,l.oR)(),i=(0,l.I0)();return(0,r.useEffect)((()=>{const e=s.reducerManager.getMountedReducers();return Object.entries(n).forEach((a=>{let[n,r]=a;e[n]||(s.reducerManager.add(n,r),i({type:"@INIT ".concat(n," reducer")}))})),()=>{o&&Object.entries(n).forEach((e=>{let[a,n]=e;s.reducerManager.remove(a),i({type:"@DESTROY ".concat(a," reducer")})}))}}),[]),(0,t.jsx)(t.Fragment,{children:a})}}}]);